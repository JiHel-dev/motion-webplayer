$(function(){function k(a){$("#username").remove();$("#name").remove();$("#company").remove();$("#email").remove();$("#phone").remove();var e=[];$.each(a,function(a,b){var c={};c.id=b.id;c.firstname=b.firstname;c.lastname=b.lastname;c.email=b.email;c.company=b.company;c.phone=b.phone;c.pseudo=b.pseudo;e.push(c);localStorage.setItem("userInfo",JSON.stringify(c));""==c.pseudo?$("#user-info").append("<span>"+c.firstname+"</span>"):$("#user-info").append("<span>"+c.pseudo+"</span>")});a=JSON.parse(localStorage.userInfo);
""==a.firstname&&""==a.lastname||$("#details-user-info").append('<a id="email" class="dropdown-item" href="#"><i class="fas fa-user fa-fw"></i>&nbsp;<span>'+a.firstname+" "+a.lastname+"</span></a>");""!=a.company&&$("#details-user-info").append('<a id="email" class="dropdown-item" href="#"><i class="fas fa-home fa-fw"></i>&nbsp;<span>'+a.company+"</span></a>");""!=a.email&&$("#details-user-info").append('<a id="email" class="dropdown-item" href="#"><i class="fas fa-envelope fa-fw"></i>&nbsp;<span>'+
a.email+"</span></a>");""!=a.phone&&$("#details-user-info").append('<a id="phone" class="dropdown-item" href="#"><i class="fas fa-phone fa-fw"></i>&nbsp;<span>'+a.phone+"</span></a>")}function l(a,e){0!=a&&$.each(a,function(a,b){var c="<b>Info<hr id='hr-data'><span class='trn'>popup.City</span> - &nbsp;"+b.city_name+"</b><br><b>IP&nbsp; - &nbsp;"+e+"</br>";$("#tbody-geoip").append('<tr id="tr-geoip"><td class="trn">'+e+'</td><td class="trn">'+b.country_code+'</td><td class="trn">'+b.country_name+
'</td><td class="trn">'+b.city_name+'</td><td class="trn">'+b.time_zone+"</td></tr>");var d=L.marker([b.latitude,b.longitude]);g.addLayer(d);d.bindPopup(c);m.push(d)});d.addLayer(g)}console.log("Geo IP");$("#geoip_card").remove();$("#geoip-div").append('<div id="geoip_card"></div>');$("#tr-geoip").remove();var f="https://connect.faun.fr/api/public";$.ajax({type:"GET",url:f+"/user_info",dataType:"json",data:{},headers:{"faun-token":token},success:function(a){k(a)},error:function(a){console.log(a)}});
var d=L.map("geoip_card",{center:[26.31731,3.655904],zoom:2,dragging:!0,worldCopyJump:!0});L.tileLayer("https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",{attribution:'Powered by \u00a9 <a href="//osm.org/copyright">OpenStreetMap</a>',minZoom:1,maxZoom:15}).addTo(d);d.addControl(new L.Control.Fullscreen);f="https://vpn.faun.com";var g=L.markerClusterGroup({maxClusterRadius:80}),m=[],h=0;$.each("3.89.39.116 185.53.88.19 167.250.8.6 195.154.60.195 88.235.218.168 201.76.127.39 95.5.228.223 70.112.168.4 93.9.64.198 27.254.158.129 218.250.162.232 154.211.14.28 157.230.128.187 209.17.97.82 84.102.194.89 86.60.195.5 95.97.149.161 47.52.66.20 103.48.168.250 18.220.66.54 200.66.75.13 81.182.208.63 14.102.6.134 202.66.164.135 117.102.226.206 191.19.63.210 185.165.169.28 178.73.215.171 213.148.194.161 103.85.121.126 45.71.228.7 203.187.226.122 51.15.142.164 170.78.3.100 187.0.165.215 80.82.70.118 73.27.28.54 159.203.169.16 185.189.196.33 195.154.60.195 188.214.128.172 191.114.36.33 89.159.230.246 5.154.106.123 167.250.195.14 198.108.66.128 168.205.224.14 177.138.187.227 165.16.37.185 91.109.194.182 51.38.12.23 45.7.118.50 186.211.108.114 104.131.145.55 3.85.4.81 116.193.219.50 103.12.161.245 177.101.178.85 92.184.101.123 191.96.214.45".split(" "),
function(a,d){$.ajax({type:"POST",url:f+"/geoip",dataType:"json",data:{ip_addr:d},success:function(a){l(a,d)},error:function(a){console.log(a)}})});$('a[href="#geoip"]').on("shown.bs.tab",function(a){d.invalidateSize();h||($("#GeoIPTable").DataTable({responsive:!0}).columns.adjust(),h=1)})});